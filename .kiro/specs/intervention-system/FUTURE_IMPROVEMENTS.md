# Future Improvements - Intervention System

intervention-system仕様の実装完了時点（2026-01-05）で、意図的に延期された項目のリスト。
次の仕様書作成時の参考資料として。

---

## 1. 課金・サブスクリプション

| 項目 | 説明 | 優先度 |
|------|------|--------|
| 課金フローへの遷移 | ai-preview.tsxから課金画面への導線 | P2 |
| トライアル期限切れUI改善 | ExpiredSubscriptionScreenの詳細化 | P3 |

---

## 2. AI機能最適化

### 2.1 パフォーマンス
| 項目 | 説明 | 技術的考慮 |
|------|------|-----------|
| 会話圧縮 | 履歴が予算の80%超過時に古いメッセージを要約 | LLM依存、トークン削減効果大 |
| バックグラウンドダウンロード | モデルDLをバックグラウンドで継続 | expo-background-fetch検討 |
| LRUデータ削除 | 長期メモリの古いデータを自動削除 | 50件上限は実装済み |

### 2.2 デバイス互換性
| 項目 | 説明 | 技術的考慮 |
|------|------|-----------|
| RAM互換性チェック | RAM ≥ 2GB判定 | ネイティブモジュール必要 |
| 非対応時UI | AIタブの非表示/無効化 | 互換性チェック実装後 |

### 2.3 UX改善
| 項目 | 説明 | 優先度 |
|------|------|--------|
| ペルソナ設定UI（オンボーディング） | 初回セットアップで選択 | P2 |
| ペルソナ設定UI（設定画面） | 後から変更可能に | P2 |
| 毎日チェックイン通知 | 定期的なAI会話促進 | P3 |
| 通知設定UI | 通知のON/OFF、時間設定 | P3 |

### 2.4 セッション管理詳細
| 項目 | 説明 | 現状 |
|------|------|------|
| セッション終了検知 | AppState監視で検知 | 基本実装あり |
| 自動保存（30秒ごと） | 定期的な状態永続化 | 未実装 |
| 中断セッション復元 | アプリ再起動時の復元 | 未実装 |
| 非アクティブタイムアウト | 5分で自動終了 | 未実装 |

---

## 3. データ安定性

| 項目 | 説明 | 実装タイミング |
|------|------|---------------|
| スキーマバージョニング | AsyncStorage/SecureStorageのバージョン管理 | 安定化フェーズ |
| マイグレーション関数 | バージョン間データ変換 | 安定化フェーズ |
| 起動時マイグレーション | 自動アップグレード | 安定化フェーズ |
| データ復旧機能 | 破損データからの復元 | 安定化フェーズ |

---

## 4. 統計・分析

| 項目 | 説明 | 依存 |
|------|------|------|
| フリクション介入成功率 | 介入後に「やめる」を選んだ率 | 統計拡張 |
| 意図別統計表示 | ダッシュボードで意図カテゴリ別グラフ | UI設計必要 |

---

## 5. ドキュメント・品質

| 項目 | 説明 | 優先度 |
|------|------|--------|
| プライバシーポリシー更新 | ローカルLLM使用の明記 | P1（リリース前必須） |
| i18nキー命名規則文書化 | 一貫した命名パターン定義 | P3 |
| 追加ペルソナ設計 | 既存サービス調査→新ペルソナ | P3 |

---

## 6. 準備段階タスク（未実施）

これらは仕様策定時の準備タスクで、実装フェーズでスキップされた項目：

- [ ] requirements.md のレビュー完了
- [ ] design.md のレビュー完了
- [ ] ユニットテスト作成（useSubscriptionAccess等）← PR #33で部分実装
- [ ] UI/UXモックアップ作成
- [ ] 既存コードへの影響分析

---

## 推奨：次の仕様書での優先順位

### 高優先度（次スプリント候補）
1. プライバシーポリシー更新（リリースブロッカー）
2. 課金フロー実装
3. ペルソナ設定UI

### 中優先度
4. 会話圧縮
5. セッション管理詳細
6. 統計拡張

### 低優先度（安定化後）
7. スキーマバージョニング
8. デバイス互換性チェック
9. バックグラウンドダウンロード

---

*作成日: 2026-01-05*
*ベース仕様: .kiro/specs/intervention-system/*
