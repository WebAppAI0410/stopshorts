# StopShorts - 要件定義書 v2.0

## 0. 文書情報

| 項目 | 内容 |
|------|------|
| 文書名 | 要件定義書 - StopShorts（ショート動画視聴抑制アプリ） |
| バージョン | 2.0 |
| 作成日 | 2025-12-19 |
| 最終更新 | 2025-12-20 |
| 対象プラットフォーム | iOS（App Store公開が主目的） |
| 開発環境 | Windows + EAS Build（クラウド） |

### 変更履歴

| バージョン | 日付 | 変更内容 |
|-----------|------|----------|
| 1.0 | 2025-12-19 | 初版作成 |
| 2.0 | 2025-12-20 | 現行実装に合わせて更新（v3オンボーディング、モック実装前提） |

---

## 1. エグゼクティブサマリー

### 1.1 プロダクトビジョン

**「ショート動画を、やめる。」**

TikTok、YouTube Shorts、Instagram Reelsへの無意識な依存から脱却し、ユーザーが自分の時間を主体的にコントロールできるようにする行動変容アプリ。

### 1.2 コアバリュー

| 価値 | 説明 |
|------|------|
| **強制的な介入** | 意思力に頼らず、iOSのScreen Time APIでシステムレベルで遮断（※entitlement取得後） |
| **コミットメントデバイス** | 前払い制により「やめたい」意思を経済的にコミット |
| **行動科学に基づく設計** | 習慣ループの分断、If-Thenプラン、損失回避を活用 |
| **自己効力感の醸成** | 成功体験の可視化により継続的な行動変容を促進 |

### 1.3 現行実装状況

| 領域 | 状態 | 備考 |
|------|------|------|
| オンボーディング | 実装済 | v3（10ステップ構成） |
| 遮断機能 | モック実装 | Family Controls entitlement未取得 |
| 統計・可視化 | UI実装済 | 実データ連携は未接続 |
| 課金 | 未実装 | Screen Time APIマネタイズ制約考慮中 |

---

## 2. 市場・ユーザー分析

### 2.1 ターゲットユーザー

**プライマリ：デジタルデトックス意識層（18-35歳）**

| セグメント | 特徴 | 動機 |
|-----------|------|------|
| **学生** | 試験期間や就活中にSNSをやめたい | 集中力向上、時間確保 |
| **若手社会人** | 夜の時間を有意義に使いたい | 睡眠改善、自己投資 |
| **クリエイター** | インプット過多から創作時間を確保したい | アウトプット時間の確保 |
| **メンタルヘルス重視層** | SNS疲れ、比較疲れから解放されたい | 精神的健康 |

### 2.2 ペインポイント

```
【表面的な問題】
"気づいたら1時間経っていた"
"寝る前に見始めて睡眠時間が減った"
"やめたいのにやめられない"

【根本的な問題】
- 変動報酬（次の動画が面白いかもしれない）による依存
- 無限スクロールによる終了タイミングの欠如
- 意思力だけでは抗えないアルゴリズム最適化
```

### 2.3 競合分析

| アプリ | 強み | 弱み |
|--------|------|------|
| iOS純正Screen Time | 無料、システム統合 | パーソナライズなし、簡単に解除可能 |
| Freedom | 多プラットフォーム対応 | サブスク高い、日本語対応弱い |
| Forest | ゲーミフィケーション | 能動的に起動が必要 |
| **StopShorts（本アプリ）** | 前払いコミット、パーソナライズ、シンプル | iOS限定（MVP） |

---

## 3. 行動変容設計

### 3.1 理論的基盤

本アプリは以下の行動科学理論を実装に反映する：

#### 3.1.1 習慣ループの分断（BJ Fogg / Charles Duhigg）

```
[キュー] → [ルーティン] → [報酬]

ショート動画の習慣ループ：
退屈・ストレス → ショート動画視聴 → ドーパミン放出

StopShortsによる介入：
退屈・ストレス → ショート動画視聴 → [5分でShield] → 中断
                                    ↓
                              代替行動の提案
```

#### 3.1.2 コミットメントデバイス（行動経済学）

- **前払い制**：金銭的コミットにより「続けなきゃ損」心理を活用
- **損失回避**：「今やめれば返金」より「続ければ節約した時間が可視化」
- **サンクコスト**の正の活用

#### 3.1.3 If-Thenプラン（Implementation Intentions）

```
「もし[トリガー]になったら、[行動]をする」

例：
「もしショート動画を開きそうになったら、深呼吸を3回する」
「もし暇だと感じたら、本を読む」
```

オンボーディングでユーザー自身に設定させる。

### 3.2 介入設計

| タイミング | 介入内容 | 心理メカニズム |
|-----------|---------|---------------|
| 5分到達時 | Shield表示 + リマインド文言 | 習慣ループの物理的分断 |
| Shield表示時 | パーソナライズされたメッセージ | 自己説得、目的想起 |
| アプリ終了後 | 「節約した時間」表示 | 即時報酬、自己効力感 |
| 翌日 | ストリーク継続通知 | 一貫性の原理 |

---

## 4. 機能要件

### 4.1 FR-001: オンボーディング（v3 10ステップ構成）

| ID | 要件 | 実装ファイル | 状態 |
|----|------|-------------|------|
| FR-001-1 | ウェルカム画面 | `welcome.tsx` | 実装済 |
| FR-001-2 | 問題提起（脳ハック） | `the-problem.tsx` | 実装済 |
| FR-001-3 | 目的設定（Goal） | `goal.tsx` | 実装済 |
| FR-001-4 | 動機設定（Motivation） | `motivation.tsx` | 実装済 |
| FR-001-5 | Screen Time権限取得 | `screentime-permission.tsx` | 実装済（モック） |
| FR-001-6 | 対象アプリ選択 | `app-selection.tsx` | 実装済（UI） |
| FR-001-7 | 使用時間の現実確認 | `reality-check.tsx` | 実装済（モック） |
| FR-001-8 | 代替活動の設定 | `alternative.tsx` | 実装済 |
| FR-001-9 | If-Thenプラン設定 | `if-then.tsx` | 実装済 |
| FR-001-10 | 機能説明・開始 | `how-it-works.tsx`, `start.tsx` | 実装済 |

#### データモデル

```typescript
// 目的設定
type Goal = 'sleep' | 'productivity' | 'mindfulness' | 'relationships' | 'creativity';

// 動機設定
type Motivation =
  | 'sleepQuality' | 'morningRoutine'      // sleep
  | 'focusWork' | 'deepWork'               // productivity
  | 'mentalClarity' | 'presentMoment'      // mindfulness
  | 'qualityTime' | 'realConnections'      // relationships
  | 'creativeTime' | 'inspiration';        // creativity

// 代替活動
type AlternativeActivity = 'reading' | 'exercise' | 'meditation' | 'learning' | 'hobby' | 'social' | 'custom';

// If-Thenプラン
type IfThenAction = 'breathe' | 'walk' | 'water' | 'stretch' | 'music' | 'custom';
```

### 4.2 FR-002: 遮断機能（コア）

| ID | 要件 | 状態 | 備考 |
|----|------|------|------|
| FR-002-1 | 5分到達で遮断 | モック準備中 | entitlement取得後に接続 |
| FR-002-2 | Shield画面表示 | UI実装済 | `shield.tsx` |
| FR-002-3 | パーソナライズ文言 | 実装済 | `personalization.ts` |
| FR-002-4 | 閉じるアクション | 未接続 | iOS制約/実装方針待ち |

### 4.3 FR-003: 統計・可視化

| ID | 要件 | 状態 | 備考 |
|----|------|------|------|
| FR-003-1 | 今日の介入回数 | 実装済 | `useAppStore.stats` |
| FR-003-2 | 週間サマリー | UI実装済 | `statistics.tsx` |
| FR-003-3 | 節約時間の計算 | 実装済 | 実測連動は未接続 |
| FR-003-4 | ストリーク表示 | UI実装済 | `StreakIndicator` |

### 4.4 FR-004: 設定

| ID | 要件 | 状態 | 備考 |
|----|------|------|------|
| FR-004-1 | 対象アプリ変更 | UI実装済 | `settings.tsx` |
| FR-004-2 | 目的・動機変更 | 実装済 | オンボーディング設定を再編集 |
| FR-004-3 | 代替活動変更 | 実装済 | - |
| FR-004-4 | If-Thenプラン変更 | 実装済 | - |

### 4.5 将来実装予定

| カテゴリ | 機能 | 優先度 |
|---------|------|--------|
| 遮断設定 | しきい値可変（3/5/10/15分） | 高 |
| 時間帯設定 | 平日/休日、時間帯別プロファイル | 中 |
| ゲーミフィケーション | バッジ、レベル、週間チャレンジ | 中 |
| 振り返り | 週次レポート、月間サマリー | 低 |
| 課金 | サブスクリプション連携 | entitlement取得後 |

---

## 5. 非機能要件

### 5.1 パフォーマンス

| 項目 | 要件 | 現状 |
|------|------|------|
| 遮断応答時間 | 5分到達から1秒以内にShield表示 | 検証不可（entitlement待ち） |
| アプリ起動時間 | 2秒以内 | 達成 |
| バッテリー消費 | バックグラウンド動作で1%/時間以下 | 未検証 |

### 5.2 セキュリティ・プライバシー

| 項目 | 要件 | 状態 |
|------|------|------|
| データ保存 | ローカルのみ（MVPはサーバー不要） | 反映済（AsyncStorage） |
| 暗号化 | iOS標準の暗号化に準拠 | 反映済 |
| 権限 | Screen Time API以外は最小限 | 反映済 |

### 5.3 可用性

| 項目 | 要件 |
|------|------|
| 遮断機能の信頼性 | 99.9%（遮断が効かない = 製品価値崩壊） |
| エラー復帰 | 遮断失敗時の手動介入導線 |

### 5.4 アクセシビリティ

| 項目 | 要件 | 状態 |
|------|------|------|
| VoiceOver | 全画面対応 | 未検証 |
| Dynamic Type | 対応 | 未検証 |
| カラーコントラスト | WCAG 2.1 AA準拠 | textMuted改善済 |

---

## 6. 技術制約・リスク

### 6.1 Screen Time API制約

| 制約 | 対策 | 状態 |
|------|------|------|
| マネタイズ禁止（4.10） | 遮断機能は無料、付加価値で課金 | 設計反映済 |
| Family Controls entitlement必須 | Appleに申請予定 | **未取得** |
| プライバシーガイドライン | 最小限の権限、ローカル保存 | 反映済 |

### 6.2 技術リスク

| リスク | 影響 | 対策 |
|--------|------|------|
| entitlement未取得 | 遮断機能がモックのまま | Apple申請を優先 |
| Expo + iOS拡張がexperimental | ビルド失敗の可能性 | 拡張は最小限に |
| WindowsでiOSローカルビルド不可 | 開発速度低下 | EAS Build中心の運用 |
| Screen Time APIの挙動変更 | 遮断が効かなくなる | iOS beta段階での検証 |

---

## 7. 成功指標（KPI）

### 7.1 北極星指標

**「週間ショート動画視聴時間の削減率」**

### 7.2 詳細KPI

| カテゴリ | 指標 | 目標（3ヶ月後） |
|---------|------|----------------|
| 獲得 | App Store CTR | 5%以上 |
| 獲得 | オンボーディング完了率 | 70%以上 |
| 活性化 | D1継続率 | 50%以上 |
| 活性化 | D7継続率 | 30%以上 |
| リテンション | 月間アクティブ率 | 40%以上 |
| 収益 | 課金転換率 | 5%以上 |
| 成果 | 視聴時間削減率 | 平均30%以上 |

---

## 8. 用語定義

| 用語 | 定義 |
|------|------|
| Shield | Screen Time APIによる遮断画面 |
| 介入 | Shieldが表示されたイベント |
| ストリーク | 連続してShieldを閉じた（対象アプリを終了した）日数 |
| 節約時間 | 介入により推定で防いだ視聴時間 |
| Goal | ユーザーの主要な目的（睡眠、生産性等） |
| Motivation | Goal内での具体的な動機 |
| If-Thenプラン | 「もし〜なら、〜する」形式の行動計画 |
| 代替活動 | ショート動画の代わりに行う活動 |

---

## 付録A: 参照ドキュメント

- [Screen Time API - WWDC21](https://developer.apple.com/videos/play/wwdc2021/10123/)
- [App Review Guidelines](https://developer.apple.com/app-store/review/guidelines/)
- [Expo iOS App Extensions](https://docs.expo.dev/build-reference/app-extensions/)
- [EAS Build Configuration](https://docs.expo.dev/build/eas-json/)

## 付録B: 関連ドキュメント

- `docs/requirements_implementation_matrix.md` - 要件・実装対応表
- `docs/design/01_screen_design.md` - 画面設計書
- `docs/ONBOARDING_FLOW.md` - オンボーディングフロー定義
